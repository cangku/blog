{"remainingRequest":"/Users/unofficial/www/learn/blog.unofficial.cn/quick-react/src/components/node_modules/thread-loader/dist/cjs.js??ref--11-1!/Users/unofficial/www/learn/blog.unofficial.cn/quick-react/src/components/node_modules/docz-core/node_modules/babel-loader/lib/index.js??ref--11-2!/Users/unofficial/www/learn/blog.unofficial.cn/quick-react/src/components/node_modules/source-map-loader/index.js!/Users/unofficial/www/learn/blog.unofficial.cn/quick-react/src/components/src/Upload/thumbnail.tsx","dependencies":[{"path":"/Users/unofficial/www/learn/blog.unofficial.cn/quick-react/src/components/src/Upload/thumbnail.tsx","mtime":1559038656659},{"path":"/Users/unofficial/www/learn/blog.unofficial.cn/quick-react/src/components/node_modules/cache-loader/dist/cjs.js","mtime":1558688755386},{"path":"/Users/unofficial/www/learn/blog.unofficial.cn/quick-react/src/components/node_modules/thread-loader/dist/cjs.js","mtime":1558688757123},{"path":"/Users/unofficial/www/learn/blog.unofficial.cn/quick-react/src/components/node_modules/docz-core/node_modules/babel-loader/lib/index.js","mtime":1558688755152},{"path":"/Users/unofficial/www/learn/blog.unofficial.cn/quick-react/src/components/node_modules/source-map-loader/index.js","mtime":1558688757088}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvVXNlcnMvdW5vZmZpY2lhbC93d3cvbGVhcm4vYmxvZy51bm9mZmljaWFsLmNuL3F1aWNrLXJlYWN0L3NyYy9jb21wb25lbnRzL25vZGVfbW9kdWxlcy9iYWJlbC1wcmVzZXQtcmVhY3QtYXBwL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL1VzZXJzL3Vub2ZmaWNpYWwvd3d3L2xlYXJuL2Jsb2cudW5vZmZpY2lhbC5jbi9xdWljay1yZWFjdC9zcmMvY29tcG9uZW50cy9ub2RlX21vZHVsZXMvYmFiZWwtcHJlc2V0LXJlYWN0LWFwcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4gZnJvbSAiL1VzZXJzL3Vub2ZmaWNpYWwvd3d3L2xlYXJuL2Jsb2cudW5vZmZpY2lhbC5jbi9xdWljay1yZWFjdC9zcmMvY29tcG9uZW50cy9ub2RlX21vZHVsZXMvYmFiZWwtcHJlc2V0LXJlYWN0LWFwcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiI7CmltcG9ydCBfZ2V0UHJvdG90eXBlT2YgZnJvbSAiL1VzZXJzL3Vub2ZmaWNpYWwvd3d3L2xlYXJuL2Jsb2cudW5vZmZpY2lhbC5jbi9xdWljay1yZWFjdC9zcmMvY29tcG9uZW50cy9ub2RlX21vZHVsZXMvYmFiZWwtcHJlc2V0LXJlYWN0LWFwcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZ2V0UHJvdG90eXBlT2YiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIi9Vc2Vycy91bm9mZmljaWFsL3d3dy9sZWFybi9ibG9nLnVub2ZmaWNpYWwuY24vcXVpY2stcmVhY3Qvc3JjL2NvbXBvbmVudHMvbm9kZV9tb2R1bGVzL2JhYmVsLXByZXNldC1yZWFjdC1hcHAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKdmFyIF9qc3hGaWxlTmFtZSA9ICIvVXNlcnMvdW5vZmZpY2lhbC93d3cvbGVhcm4vYmxvZy51bm9mZmljaWFsLmNuL3F1aWNrLXJlYWN0L3NyYy9jb21wb25lbnRzL3NyYy9VcGxvYWQvdGh1bWJuYWlsLnRzeCI7CgooZnVuY3Rpb24gKCkgewogIHZhciBlbnRlck1vZHVsZSA9ICh0eXBlb2YgcmVhY3RIb3RMb2FkZXJHbG9iYWwgIT09ICd1bmRlZmluZWQnID8gcmVhY3RIb3RMb2FkZXJHbG9iYWwgOiByZXF1aXJlKCdyZWFjdC1ob3QtbG9hZGVyJykpLmVudGVyTW9kdWxlOwogIGVudGVyTW9kdWxlICYmIGVudGVyTW9kdWxlKG1vZHVsZSk7Cn0pKCk7CgppbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50IH0gZnJvbSAicmVhY3QiOwppbXBvcnQgc3R5bGVzIGZyb20gIi4vdGh1bWJuYWlsLm1vZHVsZS5zdHlsIjsKCnZhciBUaHVtYm5haWwgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uIChfQ29tcG9uZW50KSB7CiAgX2luaGVyaXRzKFRodW1ibmFpbCwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIFRodW1ibmFpbCgpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUaHVtYm5haWwpOwoKICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoVGh1bWJuYWlsKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTsKICB9CgogIF9jcmVhdGVDbGFzcyhUaHVtYm5haWwsIFt7CiAgICBrZXk6ICJjb21wcmVzcyIsCgogICAgLyoqCiAgICAgKiDljovnvKnljp/lm74KICAgICAqIEBwYXJhbSBpbWcg5Y6f5Zu+5Zyw5Z2ACiAgICAgKiBAcGFyYW0gbWF4V2lkdGgg5pyA5aSn5a695bqmCiAgICAgKiBAcGFyYW0gbWF4SGVpZ2h0IOacgOWkp+mrmOW6pgogICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcHJlc3MoaW1nLCBtYXhXaWR0aCwgbWF4SGVpZ2h0KSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBtYXhXaWR0aCA9IG1heFdpZHRoIHx8IDc1MDsKICAgICAgbWF4SGVpZ2h0ID0gbWF4SGVpZ2h0IHx8IDEzMzQ7CiAgICAgIHZhciBjYW52YXMgPSB0aGlzLnJlZnMuY2FudmFzOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHZhciBpbWFnZSA9IG5ldyBJbWFnZSgpOwogICAgICAgIGltYWdlLnNyYyA9IGltZzsKCiAgICAgICAgaW1hZ2Uub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXMucmVzaXplKGltYWdlLCBjYW52YXMsIG1heFdpZHRoLCBtYXhIZWlnaHQpOwoKICAgICAgICAgIHJlc29sdmUoY2FudmFzLnRvRGF0YVVSTCgiaW1hZ2UvanBlZyIpKTsgLy8gR0VUIOWPr+S7peS4pOS4quWPguaVsCDmjqfliLbljovnvKnmr5QKICAgICAgICB9OwoKICAgICAgICBpbWFnZS5vbmVycm9yID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgcmVqZWN0KCJbaW1hZ2Ugb25lcnJvcl0gY29tcHJlc3MgZXJyb3IhIik7CiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9CiAgICAvKioKICAgICAqIOWOn+WbvuWunumZheWkp+Wwj+aMieeFp+acgOWkp+WuvemrmOi/m+ihjOe8qeaUvuW+l+WIsOWOi+e8qeWQjueahOWwuuWvuAogICAgICogQHBhcmFtIGltYWdlIOWbvueJh+WFg+e0oAogICAgICogQHBhcmFtIGNhbnZhcyDnlLvluIPlhYPntKAKICAgICAqIEBwYXJhbSBtYXhXaWR0aCDmnIDlpKflrr3luqYKICAgICAqIEBwYXJhbSBtYXhIZWlnaHQg5pyA5aSn6auY5bqmCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicmVzaXplIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZXNpemUoaW1hZ2UsIGNhbnZhcywgbWF4V2lkdGgsIG1heEhlaWdodCkgewogICAgICB2YXIgb3JpZ2luV2lkdGggPSBpbWFnZS53aWR0aCwKICAgICAgICAgIG9yaWdpbkhlaWdodCA9IGltYWdlLmhlaWdodDsKICAgICAgdmFyIHRhcmdldFdpZHRoID0gb3JpZ2luV2lkdGgsCiAgICAgICAgICB0YXJnZXRIZWlnaHQgPSBvcmlnaW5IZWlnaHQ7CgogICAgICBpZiAob3JpZ2luV2lkdGggPiBtYXhXaWR0aCB8fCBvcmlnaW5IZWlnaHQgPiBtYXhIZWlnaHQpIHsKICAgICAgICBpZiAob3JpZ2luV2lkdGggLyBvcmlnaW5IZWlnaHQgPiBtYXhXaWR0aCAvIG1heEhlaWdodCkgewogICAgICAgICAgLy8g5pu05a6977yM5oyJ54Wn5a695bqm6ZmQ5a6a5bC65a+4CiAgICAgICAgICB0YXJnZXRXaWR0aCA9IG1heFdpZHRoOwogICAgICAgICAgdGFyZ2V0SGVpZ2h0ID0gTWF0aC5yb3VuZChtYXhXaWR0aCAqIChvcmlnaW5IZWlnaHQgLyBvcmlnaW5XaWR0aCkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0YXJnZXRIZWlnaHQgPSBtYXhIZWlnaHQ7CiAgICAgICAgICB0YXJnZXRXaWR0aCA9IE1hdGgucm91bmQobWF4SGVpZ2h0ICogKG9yaWdpbldpZHRoIC8gb3JpZ2luSGVpZ2h0KSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBjYW52YXMud2lkdGggPSB0YXJnZXRXaWR0aDsKICAgICAgY2FudmFzLmhlaWdodCA9IHRhcmdldEhlaWdodDsKICAgICAgdGhpcy5yb3RhdGUoY2FudmFzLCB0YXJnZXRXaWR0aCwgdGFyZ2V0SGVpZ2h0KTsKICAgIH0KICAgIC8qKgogICAgICog5peL6L2s5Y6f5Zu+57uY5Yi25Yiw55S75biD5LiKCiAgICAgKiBAcGFyYW0gY2FudmFzIOeUu+W4gwogICAgICogQHBhcmFtIHRhcmdldFdpZHRoIOWbvueJh+WOi+e8qeWQjuWuveW6pgogICAgICogQHBhcmFtIHRhcmdldEhlaWdodCDlm77niYfljovnvKnlkI7pq5jluqYKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJyb3RhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJvdGF0ZShpbWFnZSwgY2FudmFzLCB0YXJnZXRXaWR0aCwgdGFyZ2V0SGVpZ2h0KSB7CiAgICAgIHZhciBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgY3R4LmNsZWFyUmVjdCgwLCAwLCB0YXJnZXRXaWR0aCwgdGFyZ2V0SGVpZ2h0KTsKICAgICAgdmFyIG9yaWVudGF0aW9uID0gdGhpcy5nZXRJbWFnZU9yaWVudGF0aW9uKCk7CgogICAgICBpZiAob3JpZW50YXRpb24gJiYgb3JpZW50YXRpb24gIT0gMSkgewogICAgICAgIHN3aXRjaCAob3JpZW50YXRpb24pIHsKICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgLy8g5peL6L2sOTDluqYKICAgICAgICAgICAgY2FudmFzLndpZHRoID0gdGFyZ2V0SGVpZ2h0OwogICAgICAgICAgICBjYW52YXMuaGVpZ2h0ID0gdGFyZ2V0V2lkdGg7CiAgICAgICAgICAgIGN0eC5yb3RhdGUoTWF0aC5QSSAvIDIpOyAvLyAoMCwtdGFyZ2V0SGVpZ2h0KSDku47ml4vovazljp/nkIblm77pgqPph4zojrflvpfnmoTotbflp4vngrkKCiAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoaW1hZ2UsIDAsIC10YXJnZXRIZWlnaHQsIHRhcmdldFdpZHRoLCB0YXJnZXRIZWlnaHQpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIC8vIOaXi+i9rDE4MOW6pgogICAgICAgICAgICBjdHgucm90YXRlKE1hdGguUEkpOwogICAgICAgICAgICBjdHguZHJhd0ltYWdlKGltYWdlLCAtdGFyZ2V0V2lkdGgsIC10YXJnZXRIZWlnaHQsIHRhcmdldFdpZHRoLCB0YXJnZXRIZWlnaHQpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgIC8vIOaXi+i9rC05MOW6pgogICAgICAgICAgICBjYW52YXMud2lkdGggPSB0YXJnZXRIZWlnaHQ7CiAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSB0YXJnZXRXaWR0aDsKICAgICAgICAgICAgY3R4LnJvdGF0ZSgzICogTWF0aC5QSSAvIDIpOwogICAgICAgICAgICBjdHguZHJhd0ltYWdlKGltYWdlLCAtdGFyZ2V0V2lkdGgsIDAsIHRhcmdldFdpZHRoLCB0YXJnZXRIZWlnaHQpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY3R4LmRyYXdJbWFnZShpbWFnZSwgMCwgMCwgdGFyZ2V0V2lkdGgsIHRhcmdldEhlaWdodCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICog6I635Y+W5Zu+54mH6aKE6K6+5pa55ZCRCiAgICAgKiBAcGFyYW0gZmlsZSDmlofku7blr7nosaEKICAgICAqIEByZXR1cm4gcHJvbWlzZSDlm57osIPpooTorr7mlrnlkJEKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRJbWFnZU9yaWVudGF0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRJbWFnZU9yaWVudGF0aW9uKGZpbGUpIHsKICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgIHZhciBwID0gewogICAgICAgIHJlc29sdmU6ICIiLAogICAgICAgIHJlamVjdDogIiIsCiAgICAgICAgcHJvbWlzZTogIiIKICAgICAgfTsKICAgICAgcC5wcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHAucmVzb2x2ZSA9IHJlc29sdmU7CiAgICAgICAgcC5yZWplY3QgPSByZWplY3Q7CiAgICAgIH0pOwoKICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgdmFyIHZpZXcgPSBuZXcgRGF0YVZpZXcoZS50YXJnZXQucmVzdWx0KTsKCiAgICAgICAgaWYgKHZpZXcuZ2V0VWludDE2KDAsIGZhbHNlKSAhPT0gMHhmZmQ4KSB7CiAgICAgICAgICAvLyBub3QganBlZwogICAgICAgICAgcC5yZXNvbHZlKC0yKTsKICAgICAgICB9CgogICAgICAgIHZhciBsZW5ndGggPSB2aWV3LmJ5dGVMZW5ndGg7CiAgICAgICAgdmFyIG9mZnNldCA9IDI7CgogICAgICAgIHdoaWxlIChvZmZzZXQgPCBsZW5ndGgpIHsKICAgICAgICAgIC8vIG5vdCBkZWZpbmVkCiAgICAgICAgICBpZiAodmlldy5nZXRVaW50MTYob2Zmc2V0ICsgMiwgZmFsc2UpIDw9IDgpIHAucmVzb2x2ZSgtMSk7CiAgICAgICAgICB2YXIgbWFya2VyID0gdmlldy5nZXRVaW50MTYob2Zmc2V0LCBmYWxzZSk7CiAgICAgICAgICBvZmZzZXQgKz0gMjsKCiAgICAgICAgICBpZiAobWFya2VyID09PSAweGZmZTEpIHsKICAgICAgICAgICAgaWYgKHZpZXcuZ2V0VWludDMyKG9mZnNldCArPSAyLCBmYWxzZSkgIT09IDB4NDU3ODY5NjYpIHsKICAgICAgICAgICAgICAvLyBub3QgZGVmaW5lZAogICAgICAgICAgICAgIHAucmVzb2x2ZSgtMSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBsaXR0bGUgPSB2aWV3LmdldFVpbnQxNihvZmZzZXQgKz0gNiwgZmFsc2UpID09PSAweDQ5NDk7CiAgICAgICAgICAgIG9mZnNldCArPSB2aWV3LmdldFVpbnQzMihvZmZzZXQgKyA0LCBsaXR0bGUpOwogICAgICAgICAgICB2YXIgdGFncyA9IHZpZXcuZ2V0VWludDE2KG9mZnNldCwgbGl0dGxlKTsKICAgICAgICAgICAgb2Zmc2V0ICs9IDI7CgogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhZ3M7IGkrKykgewogICAgICAgICAgICAgIGlmICh2aWV3LmdldFVpbnQxNihvZmZzZXQgKyBpICogMTIsIGxpdHRsZSkgPT09IDB4MDExMikgewogICAgICAgICAgICAgICAgLy8gb3JpZW50YXRpb24KICAgICAgICAgICAgICAgIHAucmVzb2x2ZSh2aWV3LmdldFVpbnQxNihvZmZzZXQgKyBpICogMTIgKyA4LCBsaXR0bGUpKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAoKG1hcmtlciAmIDB4ZmYwMCkgIT09IDB4ZmYwMCkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG9mZnNldCArPSB2aWV3LmdldFVpbnQxNihvZmZzZXQsIGZhbHNlKTsKICAgICAgICAgIH0KICAgICAgICB9IC8vIG5vdCBkZWZpbmVkCgoKICAgICAgICBwLnJlc29sdmUoLTEpOwogICAgICB9OwoKICAgICAgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGZpbGUpOwogICAgICByZXR1cm4gcC5wcm9taXNlOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudChSZWFjdC5GcmFnbWVudCwgbnVsbCwgUmVhY3QuY3JlYXRlRWxlbWVudCgiY2FudmFzIiwgewogICAgICAgIGNsYXNzTmFtZTogc3R5bGVzLmNhbnZhcywKICAgICAgICByZWY6ICJjYW52YXMiLAogICAgICAgIF9fc291cmNlOiB7CiAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgbGluZU51bWJlcjogMTU4CiAgICAgICAgfSwKICAgICAgICBfX3NlbGY6IHRoaXMKICAgICAgfSkpOwogICAgfQogIH0sIHsKICAgIGtleTogIl9fcmVhY3RzdGFuZGluX19yZWdlbmVyYXRlQnlFdmFsIiwKICAgIC8vIEB0cy1pZ25vcmUKICAgIHZhbHVlOiBmdW5jdGlvbiBfX3JlYWN0c3RhbmRpbl9fcmVnZW5lcmF0ZUJ5RXZhbChrZXksIGNvZGUpIHsKICAgICAgLy8gQHRzLWlnbm9yZQogICAgICB0aGlzW2tleV0gPSBldmFsKGNvZGUpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFRodW1ibmFpbDsKfShDb21wb25lbnQpOwoKZXhwb3J0IHsgVGh1bWJuYWlsIGFzIGRlZmF1bHQgfTsKCmlmICh0eXBlb2YgVGh1bWJuYWlsICE9PSAndW5kZWZpbmVkJyAmJiBUaHVtYm5haWwgJiYgVGh1bWJuYWlsID09PSBPYmplY3QoVGh1bWJuYWlsKSAmJiBPYmplY3QuaXNFeHRlbnNpYmxlKFRodW1ibmFpbCkpIHsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGh1bWJuYWlsLCAnX19maWxlbWV0YScsIHsKICAgIGVudW1lcmFibGU6IHRydWUsCiAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICB2YWx1ZTogewogICAgICBuYW1lOiAiVGh1bWJuYWlsIiwKICAgICAgZmlsZW5hbWU6ICJzcmMvVXBsb2FkL3RodW1ibmFpbC50c3giCiAgICB9CiAgfSk7Cn0KCmlmICh0eXBlb2YgVGh1bWJuYWlsICE9PSAndW5kZWZpbmVkJyAmJiBUaHVtYm5haWwgJiYgVGh1bWJuYWlsID09PSBPYmplY3QoVGh1bWJuYWlsKSAmJiBPYmplY3QuaXNFeHRlbnNpYmxlKFRodW1ibmFpbCkpIHsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGh1bWJuYWlsLCAnX19maWxlbWV0YScsIHsKICAgIGVudW1lcmFibGU6IHRydWUsCiAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICB2YWx1ZTogewogICAgICBuYW1lOiAiVGh1bWJuYWlsIiwKICAgICAgZmlsZW5hbWU6ICJzcmMvVXBsb2FkL3RodW1ibmFpbC50c3giCiAgICB9CiAgfSk7Cn0KCjsKCihmdW5jdGlvbiAoKSB7CiAgdmFyIHJlYWN0SG90TG9hZGVyID0gKHR5cGVvZiByZWFjdEhvdExvYWRlckdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyByZWFjdEhvdExvYWRlckdsb2JhbCA6IHJlcXVpcmUoJ3JlYWN0LWhvdC1sb2FkZXInKSkuZGVmYXVsdDsKCiAgaWYgKCFyZWFjdEhvdExvYWRlcikgewogICAgcmV0dXJuOwogIH0KCiAgcmVhY3RIb3RMb2FkZXIucmVnaXN0ZXIoVGh1bWJuYWlsLCAiVGh1bWJuYWlsIiwgIi9Vc2Vycy91bm9mZmljaWFsL3d3dy9sZWFybi9ibG9nLnVub2ZmaWNpYWwuY24vcXVpY2stcmVhY3Qvc3JjL2NvbXBvbmVudHMvc3JjL1VwbG9hZC90aHVtYm5haWwudHN4Iik7Cn0pKCk7Cgo7CgooZnVuY3Rpb24gKCkgewogIHZhciBsZWF2ZU1vZHVsZSA9ICh0eXBlb2YgcmVhY3RIb3RMb2FkZXJHbG9iYWwgIT09ICd1bmRlZmluZWQnID8gcmVhY3RIb3RMb2FkZXJHbG9iYWwgOiByZXF1aXJlKCdyZWFjdC1ob3QtbG9hZGVyJykpLmxlYXZlTW9kdWxlOwogIGxlYXZlTW9kdWxlICYmIGxlYXZlTW9kdWxlKG1vZHVsZSk7Cn0pKCk7"},{"version":3,"sources":["/Users/unofficial/www/learn/blog.unofficial.cn/quick-react/src/components/src/Upload/thumbnail.tsx"],"names":["React","Component","styles","Thumbnail","img","maxWidth","maxHeight","canvas","refs","Promise","resolve","reject","image","Image","src","onload","resize","toDataURL","onerror","originWidth","width","originHeight","height","targetWidth","targetHeight","Math","round","rotate","ctx","getContext","clearRect","orientation","getImageOrientation","PI","drawImage","file","reader","FileReader","p","promise","e","view","DataView","target","result","getUint16","length","byteLength","offset","marker","getUint32","little","tags","i","readAsArrayBuffer"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport styles from \"./thumbnail.module.styl\";\n\nexport default class Thumbnail extends Component {\n  /**\n   * 压缩原图\n   * @param img 原图地址\n   * @param maxWidth 最大宽度\n   * @param maxHeight 最大高度\n   */\n  compress(img: string, maxWidth: number, maxHeight: number) {\n    maxWidth = maxWidth || 750;\n    maxHeight = maxHeight || 1334;\n    const canvas: any = this.refs.canvas;\n    return new Promise((resolve, reject) => {\n      const image = new Image();\n      image.src = img;\n      image.onload = () => {\n        this.resize(image, canvas, maxWidth, maxHeight);\n        resolve(canvas.toDataURL(\"image/jpeg\")); // GET 可以两个参数 控制压缩比\n      };\n      image.onerror = () => {\n        reject(\"[image onerror] compress error!\");\n      };\n    });\n  }\n\n  /**\n   * 原图实际大小按照最大宽高进行缩放得到压缩后的尺寸\n   * @param image 图片元素\n   * @param canvas 画布元素\n   * @param maxWidth 最大宽度\n   * @param maxHeight 最大高度\n   */\n  resize(image, canvas, maxWidth, maxHeight) {\n    const originWidth = image.width,\n      originHeight = image.height;\n\n    let targetWidth = originWidth,\n      targetHeight = originHeight;\n    if (originWidth > maxWidth || originHeight > maxHeight) {\n      if (originWidth / originHeight > maxWidth / maxHeight) {\n        // 更宽，按照宽度限定尺寸\n        targetWidth = maxWidth;\n        targetHeight = Math.round(maxWidth * (originHeight / originWidth));\n      } else {\n        targetHeight = maxHeight;\n        targetWidth = Math.round(maxHeight * (originWidth / originHeight));\n      }\n    }\n    canvas.width = targetWidth;\n    canvas.height = targetHeight;\n    this.rotate(canvas, targetWidth, targetHeight);\n  }\n\n  /**\n   * 旋转原图绘制到画布上\n   * @param canvas 画布\n   * @param targetWidth 图片压缩后宽度\n   * @param targetHeight 图片压缩后高度\n   */\n  rotate(image, canvas, targetWidth, targetHeight) {\n    const ctx = canvas.getContext(\"2d\");\n    ctx.clearRect(0, 0, targetWidth, targetHeight);\n    const orientation = this.getImageOrientation();\n    if (orientation && orientation != 1) {\n      switch (orientation) {\n        case 6: // 旋转90度\n          canvas.width = targetHeight;\n          canvas.height = targetWidth;\n          ctx.rotate(Math.PI / 2);\n          // (0,-targetHeight) 从旋转原理图那里获得的起始点\n          ctx.drawImage(image, 0, -targetHeight, targetWidth, targetHeight);\n          break;\n        case 3: // 旋转180度\n          ctx.rotate(Math.PI);\n          ctx.drawImage(\n            image,\n            -targetWidth,\n            -targetHeight,\n            targetWidth,\n            targetHeight\n          );\n          break;\n        case 8: // 旋转-90度\n          canvas.width = targetHeight;\n          canvas.height = targetWidth;\n          ctx.rotate((3 * Math.PI) / 2);\n          ctx.drawImage(image, -targetWidth, 0, targetWidth, targetHeight);\n          break;\n      }\n    } else {\n      ctx.drawImage(image, 0, 0, targetWidth, targetHeight);\n    }\n  }\n\n  /**\n   * 获取图片预设方向\n   * @param file 文件对象\n   * @return promise 回调预设方向\n   */\n  getImageOrientation(file: File) {\n    const reader = new FileReader();\n    const p = {\n      resolve: \"\",\n      reject: \"\",\n      promise: \"\"\n    };\n    p.promise = new Promise((resolve, reject) => {\n      p.resolve = resolve;\n      p.reject = reject;\n    });\n    reader.onload = e => {\n      const view = new DataView(e.target.result);\n      if (view.getUint16(0, false) !== 0xffd8) {\n        // not jpeg\n        p.resolve(-2);\n      }\n      const length = view.byteLength;\n      let offset = 2;\n      while (offset < length) {\n        // not defined\n        if (view.getUint16(offset + 2, false) <= 8) p.resolve(-1);\n        const marker = view.getUint16(offset, false);\n        offset += 2;\n        if (marker === 0xffe1) {\n          if (view.getUint32((offset += 2), false) !== 0x45786966) {\n            // not defined\n            p.resolve(-1);\n          }\n\n          const little = view.getUint16((offset += 6), false) === 0x4949;\n          offset += view.getUint32(offset + 4, little);\n          const tags = view.getUint16(offset, little);\n          offset += 2;\n          for (let i = 0; i < tags; i++) {\n            if (view.getUint16(offset + i * 12, little) === 0x0112) {\n              // orientation\n              p.resolve(view.getUint16(offset + i * 12 + 8, little));\n            }\n          }\n        } else if ((marker & 0xff00) !== 0xff00) {\n          break;\n        } else {\n          offset += view.getUint16(offset, false);\n        }\n      }\n      // not defined\n      p.resolve(-1);\n    };\n    reader.readAsArrayBuffer(file);\n    return p.promise;\n  }\n\n  render() {\n    return (\n      <>\n        <canvas className={styles.canvas} ref=\"canvas\" />\n      </>\n    );\n  }\n}\n"]}]}