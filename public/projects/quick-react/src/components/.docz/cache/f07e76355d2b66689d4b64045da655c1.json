{"remainingRequest":"/Users/unofficial/www/learn/blog.unofficial.cn/quick-react/src/components/node_modules/thread-loader/dist/cjs.js??ref--11-1!/Users/unofficial/www/learn/blog.unofficial.cn/quick-react/src/components/node_modules/docz-core/node_modules/babel-loader/lib/index.js??ref--11-2!/Users/unofficial/www/learn/blog.unofficial.cn/quick-react/src/components/node_modules/source-map-loader/index.js!/Users/unofficial/www/learn/blog.unofficial.cn/quick-react/src/components/src/Upload/upload.tsx","dependencies":[{"path":"/Users/unofficial/www/learn/blog.unofficial.cn/quick-react/src/components/src/Upload/upload.tsx","mtime":1559036291355},{"path":"/Users/unofficial/www/learn/blog.unofficial.cn/quick-react/src/components/node_modules/cache-loader/dist/cjs.js","mtime":1558688755386},{"path":"/Users/unofficial/www/learn/blog.unofficial.cn/quick-react/src/components/node_modules/thread-loader/dist/cjs.js","mtime":1558688757123},{"path":"/Users/unofficial/www/learn/blog.unofficial.cn/quick-react/src/components/node_modules/docz-core/node_modules/babel-loader/lib/index.js","mtime":1558688755152},{"path":"/Users/unofficial/www/learn/blog.unofficial.cn/quick-react/src/components/node_modules/source-map-loader/index.js","mtime":1558688757088}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvVXNlcnMvdW5vZmZpY2lhbC93d3cvbGVhcm4vYmxvZy51bm9mZmljaWFsLmNuL3F1aWNrLXJlYWN0L3NyYy9jb21wb25lbnRzL25vZGVfbW9kdWxlcy9iYWJlbC1wcmVzZXQtcmVhY3QtYXBwL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL1VzZXJzL3Vub2ZmaWNpYWwvd3d3L2xlYXJuL2Jsb2cudW5vZmZpY2lhbC5jbi9xdWljay1yZWFjdC9zcmMvY29tcG9uZW50cy9ub2RlX21vZHVsZXMvYmFiZWwtcHJlc2V0LXJlYWN0LWFwcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4gZnJvbSAiL1VzZXJzL3Vub2ZmaWNpYWwvd3d3L2xlYXJuL2Jsb2cudW5vZmZpY2lhbC5jbi9xdWljay1yZWFjdC9zcmMvY29tcG9uZW50cy9ub2RlX21vZHVsZXMvYmFiZWwtcHJlc2V0LXJlYWN0LWFwcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiI7CmltcG9ydCBfZ2V0UHJvdG90eXBlT2YgZnJvbSAiL1VzZXJzL3Vub2ZmaWNpYWwvd3d3L2xlYXJuL2Jsb2cudW5vZmZpY2lhbC5jbi9xdWljay1yZWFjdC9zcmMvY29tcG9uZW50cy9ub2RlX21vZHVsZXMvYmFiZWwtcHJlc2V0LXJlYWN0LWFwcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZ2V0UHJvdG90eXBlT2YiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIi9Vc2Vycy91bm9mZmljaWFsL3d3dy9sZWFybi9ibG9nLnVub2ZmaWNpYWwuY24vcXVpY2stcmVhY3Qvc3JjL2NvbXBvbmVudHMvbm9kZV9tb2R1bGVzL2JhYmVsLXByZXNldC1yZWFjdC1hcHAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKdmFyIF9qc3hGaWxlTmFtZSA9ICIvVXNlcnMvdW5vZmZpY2lhbC93d3cvbGVhcm4vYmxvZy51bm9mZmljaWFsLmNuL3F1aWNrLXJlYWN0L3NyYy9jb21wb25lbnRzL3NyYy9VcGxvYWQvdXBsb2FkLnRzeCI7CgooZnVuY3Rpb24gKCkgewogIHZhciBlbnRlck1vZHVsZSA9ICh0eXBlb2YgcmVhY3RIb3RMb2FkZXJHbG9iYWwgIT09ICd1bmRlZmluZWQnID8gcmVhY3RIb3RMb2FkZXJHbG9iYWwgOiByZXF1aXJlKCdyZWFjdC1ob3QtbG9hZGVyJykpLmVudGVyTW9kdWxlOwogIGVudGVyTW9kdWxlICYmIGVudGVyTW9kdWxlKG1vZHVsZSk7Cn0pKCk7CgppbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50IH0gZnJvbSAicmVhY3QiOwppbXBvcnQgVGh1bWJuYWlsIGZyb20gIi4vdGh1bWJuYWlsIjsKaW1wb3J0IHN0eWxlcyBmcm9tICIuL3VwbG9hZC5tb2R1bGUuc3R5bCI7Cgp2YXIgVXBsb2FkID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhVcGxvYWQsIF9Db21wb25lbnQpOwoKICBmdW5jdGlvbiBVcGxvYWQoKSB7CiAgICB2YXIgX2dldFByb3RvdHlwZU9mMjsKCiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFVwbG9hZCk7CgogICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07CiAgICB9CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoX2dldFByb3RvdHlwZU9mMiA9IF9nZXRQcm90b3R5cGVPZihVcGxvYWQpKS5jYWxsLmFwcGx5KF9nZXRQcm90b3R5cGVPZjIsIFt0aGlzXS5jb25jYXQoYXJncykpKTsKCiAgICBfdGhpcy5wb3N0ID0gZnVuY3Rpb24gKGZpbGUpIHsKICAgICAgdmFyIF90aGlzJHByb3BzID0gX3RoaXMucHJvcHMsCiAgICAgICAgICBvbkNoYW5nZSA9IF90aGlzJHByb3BzLm9uQ2hhbmdlLAogICAgICAgICAgYWN0aW9uID0gX3RoaXMkcHJvcHMuYWN0aW9uOwoKICAgICAgaWYgKGFjdGlvbikgey8vIHVwbG9hZCB0aGVuIHJldHVybiByZW1vdGUgb3JpZ2luIHVybAogICAgICB9IGVsc2Ugey8vIHJldHVybiBsb2NhbCBvcmlnaW4gdXJsCiAgICAgICAgfQoKICAgICAgdmFyIHVybCA9ICIiOyAvLyBsb2NhbCB1cmwgb3IgcmVtb3RlIHVybAoKICAgICAgY29uc29sZS5sb2coX3RoaXMucmVmcy50aHVtYi5nZXRJbWFnZU9yaWVudGF0aW9uKGZpbGUpKTsKICAgICAgb25DaGFuZ2UgJiYgb25DaGFuZ2UoZmlsZSwgdXJsKTsKICAgIH07CgogICAgX3RoaXMudXBsb2FkID0gZnVuY3Rpb24gKGZpbGUpIHsKICAgICAgdmFyIGJlZm9yZVVwbG9hZCA9IF90aGlzLnByb3BzLmJlZm9yZVVwbG9hZDsKCiAgICAgIGlmICghYmVmb3JlVXBsb2FkKSB7CiAgICAgICAgX3RoaXMucG9zdChmaWxlKTsKICAgICAgfQoKICAgICAgdmFyIG5lZWRVcGxvYWQgPSBiZWZvcmVVcGxvYWQoZmlsZSk7CgogICAgICBpZiAobmVlZFVwbG9hZCkgewogICAgICAgIF90aGlzLnBvc3QoZmlsZSk7CiAgICAgIH0KCiAgICAgIF90aGlzLnBvc3QoZmlsZSk7CiAgICB9OwoKICAgIF90aGlzLnVwbG9hZEZpbGVzID0gZnVuY3Rpb24gKGZpbGVzKSB7CiAgICAgIGZpbGVzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZmlsZXMpOwogICAgICBmaWxlcy5mb3JFYWNoKGZ1bmN0aW9uIChmaWxlKSB7CiAgICAgICAgX3RoaXMudXBsb2FkKGZpbGUpOwogICAgICB9KTsKICAgIH07CgogICAgX3RoaXMub25DaGFuZ2UgPSBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgZmlsZXMgPSBlLnRhcmdldC5maWxlczsKCiAgICAgIF90aGlzLnVwbG9hZEZpbGVzKGZpbGVzKTsKICAgIH07CgogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFVwbG9hZCwgW3sKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICB2YXIgX3RoaXMkcHJvcHMyID0gdGhpcy5wcm9wcywKICAgICAgICAgIGFjY2VwdCA9IF90aGlzJHByb3BzMi5hY2NlcHQsCiAgICAgICAgICBtdWx0aXBsZSA9IF90aGlzJHByb3BzMi5tdWx0aXBsZTsKICAgICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgIGxpbmVOdW1iZXI6IDU3CiAgICAgICAgfSwKICAgICAgICBfX3NlbGY6IHRoaXMKICAgICAgfSwgUmVhY3QuY3JlYXRlRWxlbWVudCgiaW5wdXQiLCB7CiAgICAgICAgdHlwZTogImZpbGUiLAogICAgICAgIGNsYXNzTmFtZTogc3R5bGVzLmlucHV0LAogICAgICAgIGFjY2VwdDogYWNjZXB0LAogICAgICAgIG11bHRpcGxlOiBtdWx0aXBsZSwKICAgICAgICBvbkNoYW5nZTogdGhpcy5vbkNoYW5nZSwKICAgICAgICBfX3NvdXJjZTogewogICAgICAgICAgZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwKICAgICAgICAgIGxpbmVOdW1iZXI6IDU4CiAgICAgICAgfSwKICAgICAgICBfX3NlbGY6IHRoaXMKICAgICAgfSksIFJlYWN0LmNyZWF0ZUVsZW1lbnQoVGh1bWJuYWlsLCB7CiAgICAgICAgcmVmOiAidGh1bWIiLAogICAgICAgIF9fc291cmNlOiB7CiAgICAgICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICAgICAgbGluZU51bWJlcjogNjUKICAgICAgICB9LAogICAgICAgIF9fc2VsZjogdGhpcwogICAgICB9KSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX19yZWFjdHN0YW5kaW5fX3JlZ2VuZXJhdGVCeUV2YWwiLAogICAgLy8gQHRzLWlnbm9yZQogICAgdmFsdWU6IGZ1bmN0aW9uIF9fcmVhY3RzdGFuZGluX19yZWdlbmVyYXRlQnlFdmFsKGtleSwgY29kZSkgewogICAgICAvLyBAdHMtaWdub3JlCiAgICAgIHRoaXNba2V5XSA9IGV2YWwoY29kZSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gVXBsb2FkOwp9KENvbXBvbmVudCk7CgpleHBvcnQgeyBVcGxvYWQgYXMgZGVmYXVsdCB9OwoKaWYgKHR5cGVvZiBVcGxvYWQgIT09ICd1bmRlZmluZWQnICYmIFVwbG9hZCAmJiBVcGxvYWQgPT09IE9iamVjdChVcGxvYWQpICYmIE9iamVjdC5pc0V4dGVuc2libGUoVXBsb2FkKSkgewogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShVcGxvYWQsICdfX2ZpbGVtZXRhJywgewogICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgIHZhbHVlOiB7CiAgICAgIG5hbWU6ICJVcGxvYWQiLAogICAgICBmaWxlbmFtZTogInNyYy9VcGxvYWQvdXBsb2FkLnRzeCIKICAgIH0KICB9KTsKfQoKaWYgKHR5cGVvZiBVcGxvYWQgIT09ICd1bmRlZmluZWQnICYmIFVwbG9hZCAmJiBVcGxvYWQgPT09IE9iamVjdChVcGxvYWQpICYmIE9iamVjdC5pc0V4dGVuc2libGUoVXBsb2FkKSkgewogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShVcGxvYWQsICdfX2ZpbGVtZXRhJywgewogICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgIHZhbHVlOiB7CiAgICAgIG5hbWU6ICJVcGxvYWQiLAogICAgICBmaWxlbmFtZTogInNyYy9VcGxvYWQvdXBsb2FkLnRzeCIKICAgIH0KICB9KTsKfQoKOwoKKGZ1bmN0aW9uICgpIHsKICB2YXIgcmVhY3RIb3RMb2FkZXIgPSAodHlwZW9mIHJlYWN0SG90TG9hZGVyR2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IHJlYWN0SG90TG9hZGVyR2xvYmFsIDogcmVxdWlyZSgncmVhY3QtaG90LWxvYWRlcicpKS5kZWZhdWx0OwoKICBpZiAoIXJlYWN0SG90TG9hZGVyKSB7CiAgICByZXR1cm47CiAgfQoKICByZWFjdEhvdExvYWRlci5yZWdpc3RlcihVcGxvYWQsICJVcGxvYWQiLCAiL1VzZXJzL3Vub2ZmaWNpYWwvd3d3L2xlYXJuL2Jsb2cudW5vZmZpY2lhbC5jbi9xdWljay1yZWFjdC9zcmMvY29tcG9uZW50cy9zcmMvVXBsb2FkL3VwbG9hZC50c3giKTsKfSkoKTsKCjsKCihmdW5jdGlvbiAoKSB7CiAgdmFyIGxlYXZlTW9kdWxlID0gKHR5cGVvZiByZWFjdEhvdExvYWRlckdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyByZWFjdEhvdExvYWRlckdsb2JhbCA6IHJlcXVpcmUoJ3JlYWN0LWhvdC1sb2FkZXInKSkubGVhdmVNb2R1bGU7CiAgbGVhdmVNb2R1bGUgJiYgbGVhdmVNb2R1bGUobW9kdWxlKTsKfSkoKTs="},{"version":3,"sources":["/Users/unofficial/www/learn/blog.unofficial.cn/quick-react/src/components/src/Upload/upload.tsx"],"names":["React","Component","Thumbnail","styles","Upload","post","file","props","onChange","action","url","console","log","refs","thumb","getImageOrientation","upload","beforeUpload","needUpload","uploadFiles","files","Array","prototype","slice","call","forEach","e","target","accept","multiple","input"],"mappings":";;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,SAAP,MAAsB,aAAtB;AACA,OAAOC,MAAP,MAAmB,sBAAnB;;IAEqBC,M;;;;;;;;;;;;;;;;;;UAInBC,I,GAAO,UAAAC,IAAI,EAAI;AAAA,wBACgB,MAAKC,KADrB;AAAA,UACLC,QADK,eACLA,QADK;AAAA,UACKC,MADL,eACKA,MADL;;AAEb,UAAIA,MAAJ,EAAY,CACV;AACD,OAFD,MAEO,CACL;AACD;;AACD,UAAMC,GAAG,GAAG,EAAZ,CAPa,CAOG;;AAChBC,MAAAA,OAAO,CAACC,GAAR,CAAY,MAAKC,IAAL,CAAUC,KAAV,CAAgBC,mBAAhB,CAAoCT,IAApC,CAAZ;AACAE,MAAAA,QAAQ,IAAIA,QAAQ,CAACF,IAAD,EAAOI,GAAP,CAApB;AACD,K;;UAKDM,M,GAAS,UAAAV,IAAI,EAAI;AAAA,UACPW,YADO,GACU,MAAKV,KADf,CACPU,YADO;;AAEf,UAAI,CAACA,YAAL,EAAmB;AACjB,cAAKZ,IAAL,CAAUC,IAAV;AACD;;AACD,UAAMY,UAAU,GAAGD,YAAY,CAACX,IAAD,CAA/B;;AACA,UAAIY,UAAJ,EAAgB;AACd,cAAKb,IAAL,CAAUC,IAAV;AACD;;AACD,YAAKD,IAAL,CAAUC,IAAV;AACD,K;;UAKDa,W,GAAc,UAAAC,KAAK,EAAI;AACrBA,MAAAA,KAAK,GAAGC,KAAK,CAACC,SAAN,CAAgBC,KAAhB,CAAsBC,IAAtB,CAA2BJ,KAA3B,CAAR;AACAA,MAAAA,KAAK,CAACK,OAAN,CAAc,UAAAnB,IAAI,EAAI;AACpB,cAAKU,MAAL,CAAYV,IAAZ;AACD,OAFD;AAGD,K;;UAKDE,Q,GAAW,UAAAkB,CAAC,EAAI;AACd,UAAMN,KAAK,GAAGM,CAAC,CAACC,MAAF,CAASP,KAAvB;;AACA,YAAKD,WAAL,CAAiBC,KAAjB;AACD,K;;;;;;;6BAEQ;AAAA,yBACsB,KAAKb,KAD3B;AAAA,UACCqB,MADD,gBACCA,MADD;AAAA,UACSC,QADT,gBACSA,QADT;AAEP,aACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AACE,QAAA,IAAI,EAAC,MADP;AAEE,QAAA,SAAS,EAAE1B,MAAM,CAAC2B,KAFpB;AAGE,QAAA,MAAM,EAAEF,MAHV;AAIE,QAAA,QAAQ,EAAEC,QAJZ;AAKE,QAAA,QAAQ,EAAE,KAAKrB,QALjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAQE,oBAAC,SAAD;AAAW,QAAA,GAAG,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QARF,CADF;AAYD;;;;;;;;;;;EA/DiCP,S;;SAAfG,M;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAAAA,M","sourcesContent":["import React, { Component } from \"react\";\nimport Thumbnail from \"./thumbnail\";\nimport styles from \"./upload.module.styl\";\n\nexport default class Upload extends Component<UploadProps, UploadState> {\n  /**\n   * 提交上传文件或者本地预览文件\n   */\n  post = file => {\n    const { onChange, action } = this.props;\n    if (action) {\n      // upload then return remote origin url\n    } else {\n      // return local origin url\n    }\n    const url = \"\"; // local url or remote url\n    console.log(this.refs.thumb.getImageOrientation(file));\n    onChange && onChange(file, url);\n  };\n\n  /**\n   *上传文件前预检文件\n   */\n  upload = file => {\n    const { beforeUpload } = this.props;\n    if (!beforeUpload) {\n      this.post(file);\n    }\n    const needUpload = beforeUpload(file);\n    if (needUpload) {\n      this.post(file);\n    }\n    this.post(file);\n  };\n\n  /**\n   * 遍历文件对象依次上传文件\n   */\n  uploadFiles = files => {\n    files = Array.prototype.slice.call(files);\n    files.forEach(file => {\n      this.upload(file);\n    });\n  };\n\n  /**\n   * 选择文件\n   */\n  onChange = e => {\n    const files = e.target.files;\n    this.uploadFiles(files);\n  };\n\n  render() {\n    const { accept, multiple } = this.props;\n    return (\n      <div>\n        <input\n          type=\"file\"\n          className={styles.input}\n          accept={accept}\n          multiple={multiple}\n          onChange={this.onChange}\n        />\n        <Thumbnail ref=\"thumb\" />\n      </div>\n    );\n  }\n}\n"]}]}